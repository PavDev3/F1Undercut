import{D as I,K as S,Lb as y,Nb as D,O as g,Ob as $,Pb as m,Qb as T,U as n,a as d,b as p,j as f,p as v,v as N,va as s,w as b,wa as i}from"./chunk-CMKRVOCM.js";var C=(()=>{let r=class r{constructor(){this.http=n(y),this.seasonStore=n(T),this.state=i({season:"",drivers:[]}),this.loading=i(!0),this.error=i(null),this.season=s(()=>this.state().season),this.drivers=s(()=>this.state().drivers),this.driversSorted=s(()=>[...this.state().drivers].sort((e,a)=>{let c=Number(e.permanentNumber),h=Number(a.permanentNumber),l=Number.isFinite(c)?c:Number.POSITIVE_INFINITY,u=Number.isFinite(h)?h:Number.POSITIVE_INFINITY;if(l!==u)return l-u;let B=`${e.familyName??""} ${e.givenName??""}`.trim(),E=`${a.familyName??""} ${a.givenName??""}`.trim();return B.localeCompare(E)})),$(this.seasonStore.selectedSeason).pipe(N(t=>!!t),S(()=>this.fetchDriversBySeason()),D()).subscribe(t=>{this.state.update(e=>p(d({},e),{season:t.MRData.DriverTable.season,drivers:t.MRData.DriverTable.Drivers}))})}fetchDriversBySeason(){this.loading.set(!0),this.error.set(null);let t=this.seasonStore.selectedSeason();return this.http.get(`${m}/${t}/drivers.json`).pipe(I(()=>this.loading.set(!1)),b(e=>(console.error("Error fetching drivers:",e),this.error.set("No se pudieron cargar los pilotos."),f)),v(e=>e))}getDriverById(t){return this.state().drivers.find(e=>e.driverId===t)}fetchDriverById(t,e){return this.http.get(`${m}/${t}/drivers/${e}.json`)}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=g({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{C as a};
